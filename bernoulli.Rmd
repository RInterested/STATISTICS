---
title: 'Bernoulli Numbers'
output: 
  html_document:
    theme: readable
    includes:
      in_header: "favicon.html" 
    css: custom.css
---

### **NOTES ON STATISTICS, PROBABILITY and MATHEMATICS**

<a href="http://rinterested.github.io/statistics/index.html">
<img HEIGHT="40" WIDTH="50" src="logo.PNG"></a>

---

### Bernoulli Numbers:

---

Bernoulli numbers are important in many fields. They can be generated by inverting Pascal's triangle - or the matrix form of Pascal's triangle, excluding the $1$'s on the right of triangle (and performing an alternate minus sign pre-"conditioning", as explained [here](https://youtu.be/fw1kRz83Fj0?t=1189)):

```{r setup, include=FALSE} 
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```


---

#### FINDING BERNOULLI NUMBERS IN THE INVERTED MATRIX OF PASCAL'S TRIANGLE:

---

```{R, fig.width = 5, fig.height = 5}
library(MASS)

n = 11
asymmetric.lower.triang.Pascal = matrix(0,n,n)
for(i in 1:n){
  for(k in 0:(i-1)) 
    asymmetric.lower.triang.Pascal[i,k+1] = choose(i,k)
} 
M = asymmetric.lower.triang.Pascal
m = M * (((row(M) - col(M))%%2==1) * -1) +
M * (((row(M) - col(M))%%2==0) * 1) 
m
Faulhaber = fractions(solve(m))
flipF = Faulhaber[, ncol(Faulhaber):1]
rownames(flipF) <- c(paste('S',1:nrow(flipF)))
colnames(flipF) <- c(paste('n',ncol(flipF):1))
flipF
```


Compare to the slide on Mathologer:

<img width = 700  src ="https://user-images.githubusercontent.com/9312897/222972053-424ab2cd-3075-4cc9-85ad-4813644dd06d.png">

---

##### SUM OF POWERS

---

For instance, in the matrix above, named the Faulhaber matrix, the sum of the first $n$ natural numbers (to the power of $1$) would be given by:

$$S_1 = 1/2 \;n + 1/2 \; n^2= \frac{n\;(n+1)}2$$

whereas the sum of the first $n$ powers of $5$ would be given by

$$S_4= -1/30 \;n + 1/3 \; n^3 + 1/2 \; n^4 + 1/5 \; n^5$$

The Bernoulli numbers are in the first column, and the rest of the numbers in each diagonal depends on that first value:

$$1/2 \quad  1/2 \quad 1/2 \quad 1/2 \quad \dots$$
or 

$$2/12 \quad 3/12 \quad 4/12 \quad 5/12 \quad 6/12 \quad 7/12 \quad \dots$$

Therefore the Bernoulli numbers can be extracted as:

```{R}
(Bernoulli = Faulhaber[,1])
```

---

The sum of each row in the Faulhaber matrix adds to $1$:

```{R}
rowSums(Faulhaber)
```

which is part of the method explained by John Conway in [here](https://youtu.be/Uy1B_eGXQ0g):

The difference between each natural number $x$ to the $s$ power, e.g. $x^s= 3^s$

in 

$$1^s + 2^s + \color{red}{3}^s + 4^s+ \cdots + n^{s}$$

and the preceding sum to an immediately lower power: 

$$1^{s-1} + 2^{s-1} + \color{red}{3}^{s-1} + 4^{s-1}+ \cdots + n^{s-1}$$

is 

$$S_s(x)-S_{s-1}(s)=x^s$$

Differentiating,

$$S_s'(x)-S'_{s-1}(s)=s\;x^{s-1}$$

Therefore, for each summand, moving from one formula of a sum of powers to the next one amounts to multiplying the previous line times $s$ and integrating term by term. For instance, to go from the sum of powers of $5$ to the powers of $6$ first we must multiply the row on the formula for the powers of $5$ by $6:$

$$5\times\left(-1/30\; x + 1/3 \; x^3 + 1/2 \; x^4 + 1/5\; x^5\right)$$

and then integrating:

$$-1/12\; x^2 + 5/12 \; x^4 + 1/2 \; x^5 + 1/6\; x^6$$

Now for the punch-line all the factors have to add to $1$ because this equation must be valid for all sums up to a given natural number $n.$ Therefore if $n=1$ all the powers will be $1.$ Therefore, the missing number, i.e. the Bernoulli number is

$$B_5 = 1 + 1/12 - 5/12 - 1/2 -1/6=0$$

which is indeed the case.

---

#### CLOSED FORM AND GENERATING FUNCTION:

$$B_n=\sum_{k=0}^n\frac1{k+1}\sum_{j=0}^k(-1)^j\binom{k}{j}j^n,\quad n\ge0$$

The exponential generating function is:

$$\frac{x}{e^x-1} = \sum_{k=0}^\infty B_k \frac{x^k}{k!}$$


---
<a href="http://rinterested.github.io/statistics/index.html">Home Page</a>

**NOTE: These are tentative notes on different topics for personal use - expect mistakes and misunderstandings.**
